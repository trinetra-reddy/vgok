import{c as j,j as e,r as h,u as k,t as f}from"./index-BPKX_cgv.js";import{l as y,C as S,u as b,k as F,D as T,a as E,b as A,c as C,d as _,e as q,F as I}from"./DeleteAlert-CxMyO-el.js";import{B as P,P as $}from"./button-DZgg7u2Y.js";/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K=[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]],H=j("arrow-down",K);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M=[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]],O=j("monitor",M),V=({name:l})=>{const{control:s,formState:{errors:o}}=y();return e.jsx(S,{name:l,control:s,rules:{required:"At least one tag is required"},render:({field:{value:n,onChange:c}})=>{var x,p;const d=Array.isArray(n)?n:[],[a,u]=h.useState(""),m=r=>{if((r.key==="Enter"||r.key===",")&&a.trim()){r.preventDefault();const t=a.trim();d.includes(t)||(c([...d,t]),u(""))}},g=r=>{const t=[...d];t.splice(r,1),c(t)};return e.jsxs("div",{className:"md:col-span-2",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Tags ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:`flex flex-wrap items-center border rounded px-2 py-2 min-h-[42px] 
        ${o[l]?"border-red-500":"border-gray-300"} focus-within:ring-2 focus-within:ring-blue-500`,children:[d.map((r,t)=>e.jsxs("div",{className:"flex items-center bg-gray-200 text-sm rounded px-2 py-1 mr-2 mb-2",children:[e.jsx("span",{children:r}),e.jsx("button",{type:"button",className:"ml-2 text-gray-600 hover:text-red-600",onClick:()=>g(t),children:"Ã—"})]},t)),e.jsx("input",{type:"text",value:a,onChange:r=>u(r.target.value),onKeyDown:m,className:"flex-grow border-none outline-none p-1 text-sm",placeholder:"Add a tag"})]}),o[l]&&e.jsx("p",{className:"text-sm text-red-500 mt-1",children:(p=(x=o[l])==null?void 0:x.message)==null?void 0:p.toString()})]})}})},B=({isEdit:l=!1,type:s,forum:o=[]})=>{var u;const{register:n,formState:{errors:c}}=y(),[d,a]=h.useState(o||[]);return h.useEffect(()=>{a(o||[])},[o]),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 p-3",children:[e.jsxs("div",{className:"relative",children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Image"}),e.jsx("img",{src:"https://via.placeholder.com/380x315",alt:"Preview",className:"rounded border border-gray-300 min-h-[85%]"}),e.jsx("button",{type:"button",className:"absolute bottom-2 right-2 bg-[#4269c2] text-white p-2 rounded-full shadow",children:"ðŸ–Šï¸"})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Forum"}),e.jsxs("select",{...n("content"),className:`w-full border rounded px-3 py-2 ${c.content?"border-red-500":"border-gray-300"}`,children:[e.jsx("option",{value:"",children:"Select One"}),d.map(m=>e.jsx("option",{value:m.title,children:m.title},m.id))]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium mb-1",children:["Title",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",...n("title",{required:"Title is required"}),className:`w-full border rounded px-3 py-2 ${c.title?"border-red-500":"border-gray-300"}`}),typeof((u=c.title)==null?void 0:u.message)=="string"&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:c.title.message})]})]}),e.jsx(V,{name:"tags"}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Video URL"}),e.jsx("input",{type:"text",...n("video_url"),className:"w-full border border-gray-300 rounded px-3 py-2"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Description"}),e.jsx("textarea",{...n("description"),rows:6,className:"w-full border border-gray-300 rounded px-3 py-2"})]}),s!=="view"&&e.jsx("div",{className:"md:col-span-2",children:e.jsx("button",{type:"submit",className:"w-full bg-[#4269c2] hover:bg-[#2f55a3] text-white py-2 rounded font-semibold",children:l?"Update":"Submit"})})]})},G=({onCreateOrUpdate:l,formData:s,trigger:o,type:n,onCreate:c,onUpdate:d})=>{const[a,u]=h.useState(!1),[m,g]=h.useState([]),{user:x}=k(),p=!!s,{reset:r}=b(),t=b({defaultValues:{title:(s==null?void 0:s.title)||"",content:(s==null?void 0:s.content)||"",description:(s==null?void 0:s.description)||"",status:(s==null?void 0:s.status)||"pending",tags:(s==null?void 0:s.tags)||""}});h.useEffect(()=>{a&&s?t.reset({title:s.title,content:s.content,description:s.description,status:s.status,tags:s.tags,video_url:s.video_url}):t.reset()},[a,s,t,m]),h.useEffect(()=>{x&&v()},[x]);const v=async()=>{if(x!=null&&x.token)try{const i=await F(x.token);g(i.data||[])}catch(i){console.error("Failed to fetch forums:",i)}},w=async i=>{try{p&&(s!=null&&s.id)&&d?await d(s.id,i):i&&c&&await c(i),l==null||l(),r(),u(!1)}catch(N){f.error("Something went wrong."),console.error(N)}};return e.jsxs(T,{open:a,onOpenChange:u,children:[e.jsx(E,{asChild:!0,children:o??e.jsxs(P,{variant:"outline",className:"flex items-center gap-2 border border-[#4269c2] text-[#4269c2] hover:bg-blue-950 hover:text-white min-h-[42px] cursor-pointer",children:[e.jsx($,{size:16})," Create New"]})}),e.jsxs(A,{className:"sm:max-w-md",onInteractOutside:i=>i.preventDefault(),onEscapeKeyDown:i=>i.preventDefault(),children:[n!=="view"&&e.jsxs(C,{children:[e.jsx(_,{className:"text-lg font-bold text-blue-950",children:p?"Update Topic":"Create Topic"}),e.jsx(q,{className:"text-sm text-gray-500",children:p?"Edit the details and click update.":"Fill in the details to add a new topic."})]}),e.jsx("div",{className:"max-h-[80vh] overflow-y-auto pr-2",children:e.jsx(I,{...t,children:e.jsx("form",{onSubmit:t.handleSubmit(w),children:e.jsx(B,{isEdit:p,type:n,forum:m})})})})]})]})};export{H as A,G as C,O as M};
