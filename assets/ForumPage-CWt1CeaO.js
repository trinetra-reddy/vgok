import{j as e,c as D,r as l,u as S,t as g}from"./index-DpHCmz4P.js";import{P as C,u as E,D as P,a as T,B as y,b as L,c as R,d as A,e as q,f as I,g as z,h as M,i as O,j as B,k as H,l as $}from"./DeleteAlert-BcIM0iS5.js";import{P as V,a as G,T as J}from"./trash-2-_uKcppE-.js";function K({className:r,type:t,...a}){return e.jsx("input",{type:t,"data-slot":"input",className:D("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input flex h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",r),...a})}var Q="Label",k=l.forwardRef((r,t)=>e.jsx(C.label,{...r,ref:t,onMouseDown:a=>{var o;a.target.closest("button, input, select, textarea")||((o=r.onMouseDown)==null||o.call(r,a),!a.defaultPrevented&&a.detail>1&&a.preventDefault())}}));k.displayName=Q;var U=k;function v({className:r,...t}){return e.jsx(U,{"data-slot":"label",className:D("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",r),...t})}const F=({onCreateOrUpdate:r,forum:t,trigger:a})=>{const[d,o]=l.useState(!1),{user:i}=S(),c=!!t,{register:m,handleSubmit:x,reset:h,setValue:p,formState:{errors:s}}=E();l.useEffect(()=>{d&&t?(p("title",t.title),p("content",t.content)):h()},[d,t,h,p]);const u=async b=>{try{i&&(c&&(t!=null&&t.id)?(await z(t.id,b,i==null?void 0:i.token),g.success("Forum updated successfully.")):(await M(b,i==null?void 0:i.token),g.success("Forum created successfully.")),r==null||r(),h(),o(!1))}catch(n){g.error("Something went wrong."),console.error(n)}};return e.jsxs(P,{open:d,onOpenChange:o,children:[e.jsx(T,{asChild:!0,children:a??e.jsxs(y,{variant:"outline",className:"flex items-center gap-2 border border-[#4269c2] text-[#4269c2] hover:bg-blue-950 hover:text-white min-h-[42px] cursor-pointer",children:[e.jsx(V,{size:16})," Create New"]})}),e.jsxs(L,{className:"sm:max-w-md",children:[e.jsxs(R,{children:[e.jsx(A,{className:"text-lg font-bold text-blue-950",children:c?"Update Forum":"Create Forum"}),e.jsx(q,{className:"text-sm text-gray-500",children:c?"Edit the details and click update.":"Fill in the details to add a new forum."})]}),e.jsxs("form",{onSubmit:x(u),className:"space-y-4 mt-2",children:[e.jsxs("div",{children:[e.jsxs(v,{htmlFor:"title",children:["Title ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(K,{id:"title",...m("title",{required:!0}),className:"mt-1 h-10 border border-gray-300 rounded px-3 text-sm"}),s.title&&e.jsx("p",{className:"text-sm text-red-500 mt-1",children:"Title is required."})]}),e.jsxs("div",{children:[e.jsxs(v,{htmlFor:"content",children:["Description ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("textarea",{id:"content",...m("content",{required:!0}),className:"mt-1 min-h-[100px] border border-gray-300 rounded px-3 py-2 text-sm w-full resize-none focus:ring-2 focus:ring-blue-500"}),s.content&&e.jsx("p",{className:"text-sm text-red-500 mt-1",children:"Description is required."})]}),e.jsx(I,{className:"mt-4",children:e.jsx(y,{type:"submit",className:"w-full bg-blue-950 hover:bg-blue-900 text-white font-semibold text-sm h-11 rounded",children:c?"Update":"Submit"})})]})]})]})},Z=()=>{const r=l.useRef(!1),{user:t}=S(),[a,d]=l.useState([]),[o]=l.useState(10),[i]=l.useState(0),[c,m]=l.useState([]),x=async()=>{if(t!=null&&t.token)try{const s=await H(t.token,o,i);d(s.data||[]),m(s.data||[])}catch(s){console.error("Failed to fetch forums:",s)}};l.useEffect(()=>{r.current||(r.current=!0,x())},[]);const h=s=>{const u=s.toLowerCase(),b=a.filter(n=>{var f,j,w,N;return((j=(f=n==null?void 0:n.title)==null?void 0:f.toLowerCase())==null?void 0:j.includes(u))||((N=(w=n==null?void 0:n.content)==null?void 0:w.toLowerCase())==null?void 0:N.includes(u))});m(b)},p=async s=>{if(!(t!=null&&t.token))return Promise.resolve();await $(s,t.token)};return e.jsxs("div",{className:"space-y-6",children:[e.jsx(O,{title:"All Forums",searchPlaceholder:"Search by forum",onSearch:h,createButton:e.jsx(F,{onCreateOrUpdate:x})}),e.jsx("div",{className:"bg-white rounded-xl shadow overflow-hidden",children:e.jsxs("table",{className:"w-full text-sm table-auto",children:[e.jsx("thead",{className:"bg-blue-950 text-white",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left px-6 py-3 w-1/4",children:"TITLE"}),e.jsx("th",{className:"text-left px-6 py-3 w-auto",children:"DESCRIPTION"}),e.jsx("th",{className:"text-left px-6 py-3 whitespace-nowrap w-1/4",children:"ACTION"})]})}),e.jsx("tbody",{children:c.length>0?c.map((s,u)=>e.jsxs("tr",{className:"border-t",children:[e.jsx("td",{className:"px-6 py-4 align-top",children:s.title}),e.jsx("td",{className:"px-6 py-4 align-top",children:s.content}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx(F,{forum:s,onCreateOrUpdate:x,trigger:e.jsxs("button",{className:"flex items-center gap-2 border border-green-500 text-green-500 px-3 py-1 rounded hover:bg-green-50 text-sm",children:[e.jsx(G,{size:16})," Edit"]})}),e.jsx(B,{title:"Delete Forum?",content:"This forum will be permanently removed.",confirmLabel:"Remove",onConfirm:()=>p(s.id),onSuccess:()=>{x(),g.success(`"${s.title}" has been removed.`)},trigger:e.jsxs("button",{className:"flex items-center gap-2 border border-red-500 text-red-500 px-3 py-1 rounded hover:bg-red-50 text-sm",children:[e.jsx(J,{size:16})," Delete"]})})]})})]},u)):e.jsx("tr",{children:e.jsx("td",{colSpan:3,className:"text-center text-gray-500 px-6 py-6",children:"No forums found."})})})]})})]})};export{Z as default};
